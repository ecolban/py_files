#http://www.codewars.com/kata/numbers-that-are-a-power-of-their-sum-of-digits/train/python

h = {1: 81, 2: 512, 3: 2401, 4: 4913, 5: 5832, 6: 17576, 7: 19683, 8: 234256, 9: 390625, 10: 614656, 11: 1679616, 12: 17210368, 13: 34012224, 14: 52521875, 15: 60466176, 16: 205962976, 17: 612220032, 18: 8303765625, 19: 10460353203, 20: 24794911296, 21: 27512614111, 22: 52523350144, 23: 68719476736, 24: 271818611107, 25: 1174711139837, 26: 2207984167552, 27: 6722988818432, 28: 20047612231936, 29: 72301961339136, 30: 248155780267521, 31: 3904305912313344, 32: 45848500718449031, 33: 81920000000000000, 34: 150094635296999121, 35: 13744803133596058624, 36: 19687440434072265625, 37: 53861511409489970176, 38: 73742412689492826049, 39: 179084769654285362176, 40: 480682838924478847449, 41: 671088640000000000000, 42: 8007313507497959524352, 43: 21048519522998348950643, 44: 23316389970546096340992, 45: 2518170116818978404827136, 46: 14076019706120526112710656, 47: 146853371345156431381127623, 48: 166507350731038802170609664, 49: 213292826014568334917410816, 50: 240984500018808097135911707, 51: 2017516459574609153391845376, 52: 2670419511272061205254504361, 53: 4491199828872408503792328704, 54: 4946966739525117513427734375}

from heapq import heappush as push, heappop as pop

def power_sumDigTerm(n):
    h = []
    for b in range(2, 200):
        push_next(b, b, 1, h)
    for k in range(n):
        p, b, e = pop(h)
        push_next(p, b, e, h)
    return p

def push_next(p, b, e, h):
    p, e = p * b, e + 1
    while p < 1e28 and sum(int(i) for i in str(p)) != b:
        p, e = p * b, e + 1
    if p < 1e28: push(h, (p, b, e))
    
    
